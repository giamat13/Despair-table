<!DOCTYPE html>
<html lang="he">
<head>
<meta charset="UTF-8" />
<title>×˜×‘×œ×ª ×™×™××•×© ×¢× ×¢×“×›×•×Ÿ ××‘×•×§×¨</title>
<style>
:root {
  --bg-color: #121217;
  --text-color: #ddd;
  --text-muted: #999;
  --input-bg: #1f1f28;
  --input-border: #333;
  --accent-color: #5aa9e6;
  --accent-hover: #3a7bd5;
  --btn-bg: #2e2e3a;
  --btn-hover: #44445a;
  --danger-color: #e05a5a;
  --success-color: #6abf69;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 40px 20px;
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  background-color: var(--bg-color);
  color: var(--text-color);
  direction: rtl;
  text-align: center;
  min-height: 100vh;
}

/* ×›×•×ª×¨×ª ×¨××©×™×ª */
h1 {
  font-size: 2.8rem;
  margin-bottom: 35px;
  color: var(--accent-color);
  letter-spacing: 1.2px;
  user-select: none;
}

/* ×˜×‘×œ×” */
table {
  width: 100%;
  max-width: 900px;
  margin: 0 auto 40px auto;
  border-collapse: collapse;
  font-size: 1rem;
  color: var(--text-color);
  user-select: none;
  background-color: transparent;
  border-radius: 14px;
  overflow: hidden;
  box-shadow: 0 0 10px #111;
}

th, td {
  padding: 16px 14px;
  border-bottom: 1px solid #2a2a2a;
  text-align: center;
}

th {
  background-color: var(--accent-color);
  color: #fff;
  font-weight: 600;
}

tbody tr:nth-child(odd) {
  background-color: #181824;
}

tbody tr:nth-child(even) {
  background-color: #12121b;
}

tbody tr:hover {
  background-color: #222237;
}

/* ×›×¤×ª×•×¨×™ ××—×™×§×” ×§×˜× ×™× */
.small-btn {
  background: none;
  border: none;
  color: var(--danger-color);
  font-size: 1.4rem;
  cursor: pointer;
  transition: color 0.3s;
}

.small-btn:hover {
  color: #f77;
}

/* ×›×¤×ª×•×¨ ×¡××Ÿ ×”×™×•× */
.mark-btn {
  background-color: var(--success-color);
  border: none;
  border-radius: 12px;
  padding: 10px 22px;
  font-size: 1rem;
  cursor: pointer;
  color: #fff;
  transition: background-color 0.3s;
}

.mark-btn:hover:not(:disabled) {
  background-color: #5aaa5a;
}

.mark-btn:disabled {
  background-color: #444;
  cursor: not-allowed;
}

/* ×˜×•×¤×¡ ×™×¦×™×¨×ª ××™×¨×•×¢ ××ª×—×ª ×œ×˜×‘×œ×” */
.section {
  max-width: 720px;
  margin: 0 auto;
  padding: 25px 30px;
  background: transparent;
  border: 1px solid #2a2a2a;
  border-radius: 14px;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 18px 25px;
  color: var(--text-muted);
  text-align: right;
}

/* ×ª×•×•×™×•×ª */
.section label {
  display: block;
  font-size: 0.95rem;
  margin-bottom: 6px;
  color: var(--text-muted);
  user-select: none;
}

/* ×©×“×•×ª ×§×œ×˜ */
.section input,
.section select {
  width: 100%;
  padding: 12px 14px;
  font-size: 1rem;
  background-color: var(--input-bg);
  border: 1px solid var(--input-border);
  border-radius: 10px;
  color: var(--text-color);
  transition: background-color 0.25s, border-color 0.25s;
  direction: ltr; /* ×œ×× ×•×¢ ×‘×¢×™×•×ª ×‘×ª××¨×™×š ×•××¡×¤×¨×™× */
}

.section input:focus,
.section select:focus {
  outline: none;
  background-color: #292939;
  border-color: var(--accent-color);
  color: #fff;
}

/* ×©×“×•×ª ×©××¨×—×™×‘×™× ×¨×•×—×‘ ××œ× (×›××• ×¡×¤××Ÿ ×‘×˜×•×¤×¡) */
#birthdayInputs,
#tripInputs {
  grid-column: 1 / -1;
  display: flex;
  gap: 15px;
  flex-wrap: wrap;
  justify-content: flex-start;
  color: var(--text-color);
}

#birthdayInputs label,
#tripInputs label {
  flex-basis: 100%;
  color: var(--text-muted);
}

#birthdayInputs input,
#birthdayInputs select,
#tripInputs input {
  flex: 1 1 120px;
  min-width: 120px;
}

/* ×›×¤×ª×•×¨ ×”×•×¡×£ ××™×¨×•×¢ */
#addEventBtn {
  grid-column: 1 / -1;
  justify-self: center;
  padding: 14px 32px;
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--text-color);
  background-color: var(--btn-bg);
  border: 1px solid #444;
  border-radius: 14px;
  cursor: pointer;
  transition: background-color 0.3s, border-color 0.3s;
  user-select: none;
  width: 180px;
}

#addEventBtn:hover:not(:disabled) {
  background-color: var(--btn-hover);
  border-color: var(--accent-color);
  color: var(--accent-color);
}

#addEventBtn:disabled {
  background-color: #222;
  border-color: #222;
  color: #666;
  cursor: not-allowed;
}

/* ×¨×¡×¤×•× ×¡×™×‘×™×•×ª ×œ××•×‘×™×™×œ */
@media (max-width: 600px) {
  .section {
    grid-template-columns: 1fr;
  }

  #birthdayInputs,
  #tripInputs {
    flex-direction: column;
  }

  #birthdayInputs input,
  #birthdayInputs select,
  #tripInputs input {
    min-width: 100%;
  }

  th, td {
    padding: 12px 8px;
    font-size: 0.9rem;
  }

  .small-btn {
    font-size: 1.2rem;
  }

  #addEventBtn {
    width: 100%;
  }
}
</style>
</head>
<body>

<h1>×˜×‘×œ×ª ×™×™××•×© ğŸ­ - ××™×¨×•×¢×™× ××¨×•×‘×™×</h1>

<table id="eventsTable" style="display:none;">
  <thead>
    <tr>
      <th>××™×¨×•×¢</th>
      <th>×ª××¨×™×š</th>
      <th>×™××™× × ×©××¨×•</th>
      <th>××©×¤×˜ ××¢×•×“×“</th>
      <th>×¡××Ÿ ×”×™×•×</th>
      <th>××—×™×§×”</th>
    </tr>
  </thead>
  <tbody id="eventsBody"></tbody>
</table>

<div class="section" id="inputSection">
  <label for="eventType">×‘×—×¨ ××™×¨×•×¢:</label>
  <select id="eventType" onchange="updateForm()">
    <option value="birthday">ğŸ‚ ×™×•× ×”×•×œ×“×ª</option>
    <option value="trip">ğŸšŒ ×˜×™×•×œ</option>
  </select>

  <span id="birthdayInputs" style="display:none; grid-column: 1 / -1;">
    <label for="childName">×©×:</label>
    <input type="text" id="childName" placeholder="×©× ×”×™×œ×“/×”" />
    <label for="childAge">×’×™×œ:</label>
    <input type="number" id="childAge" min="0" placeholder="×’×™×œ" />
    <label for="childGender">××™×Ÿ:</label>
    <select id="childGender">
      <option value="male">×‘×Ÿ</option>
      <option value="female">×‘×ª</option>
    </select>
  </span>

  <span id="tripInputs" style="display:none; grid-column: 1 / -1;">
    <label for="tripPlace">××§×•× ×”×˜×™×•×œ:</label>
    <input type="text" id="tripPlace" placeholder="×”×›× ×¡ ××§×•×" />
  </span>

  <label for="targetDate">×ª××¨×™×š ×™×¢×“:</label>
  <input type="date" id="targetDate" />

  <button onclick="addEvent()" id="addEventBtn">â• ×”×•×¡×£ ××™×¨×•×¢</button>
</div>

<script>
const messages = {
  birthday: {
    "30+": [
      "ğŸ­ ×–×” ×¢×•×“ ×¨×—×•×§, ××‘×œ ×©×•×•×” ×œ×—×›×•×ª â€“ {days} ×™××™× ×œ×—×’×™×’×”!",
      "â³ ×¡×‘×œ× ×•×ª ×”×™× ×—×œ×§ ××”×›×™×£ â€“ ×¨×§ {days} ×™××™×!",
      "ğŸ‰ ××ª×—×™×œ×™× ×œ×¡×¤×•×¨ ××ª ×”×™××™× â€“ {days} ×™××™× ×œ×¤× ×™ ×”×™×•× ×”××™×•×—×“!",
      "ğŸ‚ ×”×–××Ÿ ×¢×•×“ ×¨×—×•×§, ××‘×œ ×”×”×ª×¨×’×©×•×ª ×’×“×•×œ×”!",
      "ğŸˆ ×¢×•×“ {days} ×™××™× ×©×œ ×¦×™×¤×™×™×” ××ª×•×§×”!",
      "ğŸ¥³ ××—×©×‘×™× ××ª ×”×™××™×... {days} ×™××™× ×œ× ×™×¦×•×¥!",
      "ğŸ ×¢×•×“ {days} ×™××™× â€“ ×”×›× ×•×ª ××ª×§×“××•×ª ×œ×—×’×™×’×”!",
      "âœ¨ ×œ××˜ ×œ××˜ ××ª×§×¨×‘×™× ×œ×™×•× ×”×’×“×•×œ â€“ {days} ×™××™×!",
      "ğŸ‰ ×—×’×™×’×” ×‘××•×¤×§, ×¨×§ {days} ×™××™× ×œ×”××ª×™×Ÿ!",
      "ğŸŒŸ ××—×©×‘×™× ×›×œ ×™×•× ×‘×“×¨×š â€“ {days} ×™××™×!",
      "ğŸŠ ××—×›×™× ×‘×›×™×œ×™×•×Ÿ ×¢×™× ×™×™× â€“ {days} ×™××™×!",
      "ğŸ‚ ×”×–××Ÿ ×œ×˜×¤×œ ×‘×”×›× ×•×ª â€“ {days} ×™××™× ×‘×“×™×•×§!"
    ],
    "8-30": [
      "â° ×¢×•×“ ×©×‘×•×¢ ×•×™×•×ª×¨ â€“ {days} ×™××™× ×œ×—×’×™×’×”!",
      "ğŸˆ {days} ×™××™× â€“ ×”×”×ª×¨×’×©×•×ª ××ª×’×‘×¨×ª!",
      "ğŸ‰ ×¢×•×“ ×§×¦×ª ×–××Ÿ ×¢×“ ×”×™×•× ×”×’×“×•×œ â€“ {days} ×™××™×!",
      "ğŸ¥³ ×¢×•×“ {days} ×™××™×, ××ª×›×•× × ×™× ×œ×©××•×—!",
      "âœ¨ ×¢×•×“ {days} ×™××™×, ×”××¡×™×‘×” ××ª×§×¨×‘×ª!",
      "ğŸŠ ×¡×•×¤×¨×™× ×œ××—×•×¨, {days} ×™××™× ×‘×œ×‘×“!",
      "ğŸ‚ ×”×–××Ÿ ×˜×¡, ×¢×•×“ {days} ×™××™×!",
      "ğŸŒŸ ×”×”×ª×¨×’×©×•×ª ×‘×•×¢×¨×ª, {days} ×™××™×!",
      "ğŸ ××—×›×™× ×œ×™×•× ×”××™×•×—×“ â€“ {days} ×™××™×!",
      "ğŸ‰ {days} ×™××™× ×©×œ ×¦×™×¤×™×™×” ×•×©××—×”!",
      "ğŸˆ ×¢×•×“ {days} ×™××™×, ×–×” ×›××¢×˜ ×›××Ÿ!",
      "ğŸ¥³ ×œ× × ×•×ª×¨ ×”×¨×‘×” â€“ {days} ×™××™×!"
    ],
    "1-7": [
      "â³ ×¨×§ {days} ×™××™× ×œ×”×ª×¨×’×©×•×ª ×’×“×•×œ×”!",
      "ğŸ‰ {days} ×™××™× â€“ ×§×¨×•×‘ ×××©!",
      "ğŸ‚ {days} ×™××™×, ××ª×—×™×œ×™× ×œ×¡×¤×•×¨ ×›×œ ×¨×’×¢!",
      "ğŸˆ ×¨×§ {days} ×™××™× â€“ ×”×”×ª×¨×’×©×•×ª ×‘×©×™××”!",
      "âœ¨ {days} ×™××™× ×œ××™×¨×•×¢ ×©×›×•×œ× ××—×›×™× ×œ×•!",
      "ğŸ¥³ {days} ×™××™× â€“ ××¡×™×‘×” ×‘××•×¤×§!",
      "ğŸŠ {days} ×™××™× â€“ ×œ× × ×•×ª×¨ ×–××Ÿ!"
    ],
    1: [
      "ğŸ‰ ××—×¨ ×–×” ×”×™×•×! ×—×•×’×’×™× ×‘×’×“×•×œ!",
      "ğŸ‚ ××—×¨ â€“ ×”×™×•× ×©××—×›×™× ×œ×• ×›×œ ×”×©× ×”!",
      "ğŸ¥³ ××—×¨, {name}, ×›×œ ×”××©×¤×—×” ××—×›×” ×œ×š!",
      "ğŸˆ ××—×¨ â€“ ×”×”×ª×—×œ×” ×©×œ ×©××—×” ×’×“×•×œ×”!"
    ],
    0: [
      "ğŸ‚ ×”×™×•× ×–×” ×”×™×•×! ××–×œ ×˜×•×‘ ×¢× ×§ ×œ-{name} {genderWord} ×‘×Ÿ/×‘×ª {age}!",
      "ğŸ‰ ×”×’×™×¢ ×”×¨×’×¢ ×”×’×“×•×œ! ×™×•× ×”×•×œ×“×ª ×©××— ×œ-{name}!",
      "ğŸ¥³ {name}, ×—×•×’×’×™× ××™×ª×š ×”×™×•× ×›×œ ×”×™×•×!",
      "ğŸˆ ×™×•× ×”×•×œ×“×ª ×©××—, {name}! ×ª×”× ×” ××›×œ ×¨×’×¢!"
    ]
  },
  trip: {
    "30+": [
      "ğŸ­ ×–×” ×¢×•×“ ×¨×—×•×§, ××‘×œ ×©×•×•×” ×œ×—×›×•×ª â€“ {days} ×™××™× ×œ×˜×™×•×œ ×œ{place}!",
      "ğŸ•ï¸ ××—×›×™× ×œ×˜×™×•×œ ×”×’×“×•×œ â€“ ×¨×§ {days} ×™××™×!",
      "ğŸŒ„ ××ª×›×•× × ×™× ×œ×˜×™×•×œ, {days} ×™××™× ×‘×“×¨×š!",
      "ğŸ’ ×¡×•×¤×¨×™× ×œ××—×•×¨ â€“ {days} ×™××™× ×œ×¤× ×™ ×”×˜×™×•×œ!",
      "âœ¨ ×”×”×ª×¨×’×©×•×ª ×’×•×‘×¨×ª â€“ ×¢×•×“ {days} ×™××™×!",
      "ğŸ‰ ×¢×•×“ {days} ×™××™× â€“ ××¨×™×–×” ×•×—×œ×•××•×ª!",
      "ğŸŒŸ ×”×“×¨×š ×œ×˜×™×•×œ ××ª×§×¨×‘×ª â€“ {days} ×™××™× ×‘×œ×‘×“!",
      "ğŸš ××ª×›× × ×™× ××ª ×”××¡×œ×•×œ â€“ {days} ×™××™×!",
      "ğŸ¥¾ ×¢×•×“ {days} ×™××™× â€“ ×˜×™×•×œ ×©×œ× ×™×©×›×—!",
      "ğŸŠ × ×¨×’×©×™× ×œ×˜×™×™×œ â€“ ×¨×§ {days} ×™××™×!",
      "ğŸŒ„ ×”×›× ×•×ª ××—×¨×•× ×•×ª â€“ {days} ×™××™× ×œ×˜×™×•×œ!",
      "ğŸ’ ××—×›×™× ×œ×¨×’×¢ â€“ {days} ×™××™×!"
    ],
    "8-30": [
      "âŒ› ×¡×•×¤×¨×™× ×œ××—×•×¨ ×œ×˜×™×•×œ ×œ{place} â€“ × ×©××¨×• {days} ×™××™×",
      "ğŸŒ„ ×”×”×ª×¨×’×©×•×ª ×¨×§ ××ª×—×™×œ×” â€“ {days} ×™××™× ×œ×˜×™×•×œ!",
      "ğŸ’ ×¢×•×“ {days} ×™××™× â€“ ×”×”×›× ×•×ª ×‘×¢×™×¦×•××Ÿ!",
      "âœ¨ ××ª×§×¨×‘×™× ×œ{place} â€“ ×¨×§ {days} ×™××™×!",
      "ğŸ‰ {days} ×™××™× ×•× ×¦× ×œ×“×¨×š!",
      "ğŸ¥¾ ×¢×•×“ {days} ×™××™× ×œ×˜×™×•×œ ××¨×’×©!",
      "ğŸš ××—×›×™× ×œ×˜×™×•×œ ×”×’×“×•×œ â€“ {days} ×™××™×!",
      "ğŸŒŸ ×¨×§ {days} ×™××™× ×¢×“ ×”×”×¨×¤×ª×§×”!",
      "ğŸŠ ×¡×•×¤×¨×™× ××ª ×”×™××™× â€“ {days} ×™××™×!",
      "ğŸŒ„ ×”×”×ª×¨×’×©×•×ª ×’×•×‘×¨×ª â€“ {days} ×™××™×!",
      "ğŸ’ ×¢×•×“ {days} ×™××™× â€“ ××ª×›×•× × ×™× ×‘×©×™×!",
      "âœ¨ {days} ×™××™× â€“ ×–×” ×××© ×›××Ÿ!"
    ],
    "1-7": [
      "âŒ› ×¡×•×¤×¨×™× ×œ××—×•×¨ â€“ {days} ×™××™× ×œ×˜×™×•×œ ×œ{place}!",
      "ğŸŒ„ {days} ×™××™× ×•×”×”×¨×¤×ª×§×” ××ª×—×™×œ×”!",
      "ğŸ’ {days} ×™××™× â€“ ××ª×—×™×œ×™× ×œ××¨×•×–!",
      "âœ¨ {days} ×™××™×, ×”×”×ª×¨×’×©×•×ª ×‘×©×™××”!",
      "ğŸ‰ {days} ×™××™× ×•× ×¦× ×œ×“×¨×š!",
      "ğŸ¥¾ {days} ×™××™× ×œ×˜×™×•×œ ××“×”×™×!",
      "ğŸš ×¨×§ {days} ×™××™×, ××—×›×™× ×›×‘×¨!"
    ],
    1: [
      "ğŸ’ ×›×‘×¨ ×›××¢×˜ ×™×•×¦××™× ×œ×“×¨×š ×œ{place}! ××—×¨ ×–×” ×”×™×•×!",
      "ğŸ•ï¸ ××—×¨ â€“ ×”×”×¨×¤×ª×§×” ×‘×¤×ª×—!",
      "ğŸŒ„ ××—×¨ â€“ ×”×–××Ÿ ×œ×˜×™×™×œ!",
      "ğŸ‰ ××—×¨ × ×ª×—×™×œ ××ª ×”×˜×™×•×œ!"
    ],
    0: [
      "ğŸ•ï¸ ×”×™×•× ×–×” ×”×™×•×! ×ª×”× ×• ×‘×˜×™×•×œ ×œ{place}!",
      "ğŸ’ ×”×˜×™×•×œ ××ª×—×™×œ ×”×™×•×! ×ª×™×”× ×•!",
      "ğŸŒŸ ×™×•× ×”×˜×™×•×œ ×”×’×™×¢! ×‘×”×¦×œ×—×”!",
      "ğŸ¥¾ ×˜×™×•×œ ××”× ×” ×œ×›×•×œ×!"
    ]
  }
};

const storageKey = "despairMultiEvents";

function updateForm() {
  const type = document.getElementById("eventType").value;
  document.getElementById("birthdayInputs").style.display = (type === "birthday") ? "flex" : "none";
  document.getElementById("tripInputs").style.display = (type === "trip") ? "flex" : "none";
}

function fillTemplate(template, params) {
  return template.replace(/\{(\w+)\}/g, (_, key) => params[key] || "");
}

function daysLeft(targetDateStr) {
  const today = new Date();
  const target = new Date(targetDateStr);
  today.setHours(0,0,0,0);
  target.setHours(0,0,0,0);
  return Math.ceil((target - today) / (1000*60*60*24));
}

function loadEvents() {
  const data = localStorage.getItem(storageKey);
  return data ? JSON.parse(data) : [];
}

function saveEvents(events) {
  localStorage.setItem(storageKey, JSON.stringify(events));
}

function addEvent() {
  const type = document.getElementById("eventType").value;
  const targetDate = document.getElementById("targetDate").value;
  if (!targetDate) { alert("×× × ×‘×—×¨ ×ª××¨×™×š ×™×¢×“"); return; }
  let name = "", age = "", gender = "", place = "";

  if (type === "birthday") {
    name = document.getElementById("childName").value.trim();
    age = document.getElementById("childAge").value.trim();
    gender = document.getElementById("childGender").value;
    if (!name || !age) { alert("×× × ××œ× ×©× ×•×’×™×œ ×œ×™×•× ×”×”×•×œ×“×ª"); return; }
  } else if (type === "trip") {
    place = document.getElementById("tripPlace").value.trim();
    if (!place) { alert("×× × ××œ× ××§×•× ×œ×˜×™×•×œ"); return; }
  }

  if (daysLeft(targetDate) < 0) { alert("×”×ª××¨×™×š ×›×‘×¨ ×¢×‘×¨"); return; }

  const events = loadEvents();
  events.push({
    id: Date.now(),
    type, targetDate, name, age, gender, place,
    lastMarkedDate: null,
    lastMsgUpdate: null,
    cachedMsg: ""
  });

  saveEvents(events);
  clearInputs();
  renderEvents();
}

function clearInputs() {
  document.getElementById("targetDate").value = "";
  document.getElementById("childName").value = "";
  document.getElementById("childAge").value = "";
  document.getElementById("childGender").value = "male";
  document.getElementById("tripPlace").value = "";
}

function getTimeKey(days) {
  if (days === 0) return "0";
  if (days === 1) return "1";
  if (days >= 2 && days <= 7) return "1-7";
  if (days >= 8 && days <= 30) return "8-30";
  return "30+";
}

function getGenderWord(event) {
  if (event.type !== "birthday") return "";
  if (Number(event.age) > 25) {
    return event.gender === "female" ? "××‘×•×’×¨×ª" : "××‘×•×’×¨";
  } else {
    return event.gender === "female" ? "×‘×ª" : "×‘×Ÿ";
  }
}

function getMessage(event, days) {
  if (!event.cachedMsg) {
    const key = getTimeKey(days);
    const templates = messages[event.type][key];
    if (!templates) return "";

    let index = 0;
    if (Array.isArray(templates)) {
      index = event.id % templates.length;
    }
    const template = Array.isArray(templates) ? templates[index] : templates;

    const filled = fillTemplate(template, {
      days,
      name: event.name || "×”×™×œ×“/×”",
      age: event.age || "",
      genderWord: getGenderWord(event),
      place: event.place || "×”××§×•×"
    });

    event.cachedMsg = filled;
    saveCachedMsg(event);
  }

  return event.cachedMsg;
}

function saveCachedMsg(eventToSave) {
  const events = loadEvents();
  const idx = events.findIndex(e => e.id === eventToSave.id);
  if (idx !== -1) {
    events[idx] = eventToSave;
    saveEvents(events);
  }
}

function markToday(eventId) {
  const events = loadEvents();
  const todayStr = new Date().toISOString().slice(0,10);
  const event = events.find(e => e.id === eventId);
  if (!event) return;
  if (event.lastMarkedDate === todayStr) {
    alert("×›×‘×¨ ×¡×™×× ×ª ×”×™×•×!");
    return;
  }
  event.lastMarkedDate = todayStr;
  event.lastMsgUpdate = null;
  event.cachedMsg = ""; // ×××¤×¡ ××ª ×”××©×¤×˜ ×›×“×™ ×©×™×ª×¢×“×›×Ÿ
  saveEvents(events);
  renderEvents();
}

function deleteEvent(eventId) {
  if (!confirm("×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×”××™×¨×•×¢?")) return;
  let events = loadEvents();
  events = events.filter(e => e.id !== eventId);
  saveEvents(events);
  renderEvents();
}

function renderEvents() {
  const events = loadEvents();
  const tbody = document.getElementById("eventsBody");
  const table = document.getElementById("eventsTable");
  tbody.innerHTML = "";

  if (events.length === 0) {
    table.style.display = "none";
    return;
  }
  table.style.display = "table";

  events.forEach(event => {
    const days = daysLeft(event.targetDate);
    const msg = getMessage(event, days);
    const displayDays = days;

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${event.type === "birthday" ? `ğŸ‚ ×™×•× ×”×•×œ×“×ª ×©×œ ${event.name} (${event.age})` : `ğŸšŒ ×˜×™×•×œ ×œ${event.place}`}</td>
      <td>${new Date(event.targetDate).toLocaleDateString('he-IL')}</td>
      <td>${displayDays}</td>
      <td>${msg}</td>
      <td>
        <button class="mark-btn" onclick="markToday(${event.id})" ${event.lastMarkedDate === new Date().toISOString().slice(0,10) ? "disabled" : ""}>
          ${event.lastMarkedDate === new Date().toISOString().slice(0,10) ? "âœ… ×¡×•××Ÿ ×”×™×•×! ğŸ‰ğŸ’š" : "×¡××Ÿ ×”×™×•×"}
        </button>
      </td>
      <td>
        <button class="small-btn" onclick="deleteEvent(${event.id})" title="××—×§ ××™×¨×•×¢">âŒ</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

window.onload = () => {
  updateForm();
  renderEvents();
};
</script>

</body>
</html>
